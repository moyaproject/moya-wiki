<?xml version="1.0" encoding="UTF-8"?>
<moya xmlns="http://moyaproject.com"
    xmlns:m="http://moyaproject.com"
    xmlns:img="http://moyaproject.com/imagelib"
    xmlns:w="http://moyaproject.com/widgets"
    xmlns:html="http://moyaproject.com/html">

    <form id="wiki" libname="form.page.edit" style="horizontal" xmlns="http://moyaproject.com/forms">
        <hidden-input name="revision_id" initial="revision.id" />
        <hidden-input name="page_id" initial="page.id"/>
        <input name="title" label="Title" maxlength="100" required="yes"/>
        <input label="Tags" name="tagtext" maxlength="200" required="no" placeholder="comma separated tags"/>

        <radio-group label="Markup" inline="yes" name="markup" initial=".app.settings.default_markup">
            <radio on="bbcode" text="BBCode"/>
            <radio on="html" text="HTML"/>
            <radio on="markdown" text="Markdown"/>
            <radio on="text" text="Text"/>
        </radio-group>
        <field label="Images">
            <img:manager collection="revision.images" picker="yes" picker_text="insert" on_pick="on_pick_post_images"/>
        </field>
        <field label="Content">
            <w:tab-panel>
                <w:tab title="Markup">
                    <text-area style="simple" name="content" label="Content" libname="form.post.editor" rows="20"/>
                </w:tab>
                <w:tab title="Preview">

                </w:tab>
            </w:tab-panel>
        </field>

        <actions>
            <submit-button visual="success" name="action" clicked="publish" text="Publish"/>
            <submit-button visual="default" name="action" clicked="discard" text="Discard Draft"/>
        </actions>
    </form>

    <form libname="form.page.new" csrf="no" action="." method="get" style="simple" xmlns="http://moyaproject.com/forms">
        <w:well>
            <m:md>New Wiki page</m:md>
            <input maxlength="100" name="new" placeholder="page title"/>
        </w:well>
    </form>

    <form libname="form.page.create" xmlns="http://moyaproject.com/forms">
        <w:dialog>
            <m:markdown>Are you sure you want to create wiki page *${.url.slug}*?</m:markdown>
            <w:dialog-buttons>
                <submit-button name="create" clicked="yes" text="Create Page"/>
                <submit-button visual="default" name="create" clicked="no" text="Cancel"/>
            </w:dialog-buttons>
        </w:dialog>
    </form>

    <form libname="form.page.publish" xmlns="http://moyaproject.com/forms">
        <w:dialog>
            <m:markdown>Are you sure you want to *publish* wiki page **${.url.slug}**?</m:markdown>
            <html:p>
                <input maxlength="100" name="comment" placeholder="Revision comment"/>
            </html:p>
            <w:dialog-buttons>
                <submit-button visual="primary" name="publish" clicked="yes" text="Publish Page"/>
                <submit-button visual="default" name="publish" clicked="no" text="Cancel"/>
            </w:dialog-buttons>
        </w:dialog>
    </form>

    <form libname="form.page.discard" xmlns="http://moyaproject.com/forms">
        <w:dialog>
            <m:md>Are you sure you want to *discard* draft wiki page **${.url.slug}**?</m:md>
            <w:dialog-buttons>
                <submit-button visual="primary" name="discard" clicked="yes" text="Discard Draft"/>
                <submit-button visual="default" name="discard" clicked="no" text="Cancel"/>
            </w:dialog-buttons>
        </w:dialog>
    </form>

    <form libname="form.page.default" xmlns="http://moyaproject.com/forms">
        <w:dialog>
            <m:md>
                Are you sure you want to make r${revision.version} the default page?
            </m:md>
            <w:dialog-buttons>
                <submit-button visual="primary" name="default" clicked="yes" text="Make Default"/>
                <submit-button visual="default" name="default" clicked="no" text="Cancel"/>
            </w:dialog-buttons>
        </w:dialog>
    </form>

</moya>
